## Основы синтаксиса Lua

### Переменные и типы данных

-- Объявление переменных
```lua
local number = 10          -- Число
local text = "Hello!"      -- Строка
local isActive = true      -- Булево значение
local nothing = nil        -- Пустое значение

-- Таблицы (основная структура данных)
local list = {1, 2, 3}     -- Массив
local dict = {             -- Словарь
    name = "Player1",
    health = 100
}
```
### Условные операторы
```lua
if health <= 0 then
    print("Game Over!")
elseif health < 50 then
    print("Low health!")
else
    print("Health is good!")
end

-- Тернарный оператор (эмуляция)
local message = health < 20 and "Danger!" or "Safe"
```
### Циклы

```lua
-- Цикл for
for i = 1, 5 do
    print(i)
end

-- Цикл while
local counter = 0
while counter < 3 do
    print(counter)
    counter += 1
end

-- Итерация по таблице
for key, value in pairs(dict) do
    print(key, value)
end
```
### Функции

```lua
-- Объявление функции
function add(a, b)
    return a + b
end

-- Анонимная функция
local multiply = function(a, b)
    return a * b
end

-- Вариативные функции
function sum(...)
    local total = 0
    for _, num in ipairs({...}) do
        total += num
    end
    return total
end
```
## Работа с Roblox API
### Создание и изменение объектов
```lua
-- Создание новой части
local part = Instance.new("Part")
part.Parent = workspace
part.Size = Vector3.new(5, 1, 5)
part.Position = Vector3.new(0, 5, 0)
part.BrickColor = BrickColor.new("Bright red")
part.Material = Enum.Material.Concrete
part.Anchored = true

-- Изменение свойств
part.Transparency = 0.5
part.CanCollide = false

-- Добавление искры
local sparkles = Instance.new("Sparkles")
sparkles.Parent = part

### Работа с игроками

-- Сервис игроков
local Players = game:GetService("Players")

-- Обработка входа игрока
Players.PlayerAdded:Connect(function(player)
    print(player.Name .. " joined the game!")
    
    -- Создание персонажа
    player.CharacterAdded:Connect(function(character)
        local humanoid = character:WaitForChild("Humanoid")
        humanoid.Died:Connect(function()
            print(player.Name .. " died!")
        end)
    end)
end)

-- Обработка выхода игрока
Players.PlayerRemoving:Connect(function(player)
    print(player.Name .. " left the game!")
end)

### События (Events)

-- Создание пользовательского события
local event = Instance.new("BindableEvent")
event.Name = "CustomEvent"

-- Подписка на событие
event.Event:Connect(function(message)
    print("Event received:", message)
end)

-- Активация события
event:Fire("Hello World!")

-- Удаление события при завершении
event:Destroy()

-- Задержка выполнения
wait(2)  -- Ждать 2 секунды
task.wait(0.5)  -- Более современный вариант

-- Повторяющиеся действия
while true do
    print("Tick")
    task.wait(1)
end

-- Запуск с задержкой
task.delay(3, function()
    print("This runs after 3 seconds")
end)


-- Создание ScreenGui
local gui = Instance.new("ScreenGui")
gui.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")

-- Создание текстовой метки
local label = Instance.new("TextLabel")
label.Parent = gui
label.Size = UDim2.new(0, 200, 0, 50)
label.Position = UDim2.new(0.5, -100, 0, 20)
label.Text = "Hello, Roblox!"
label.TextColor3 = Color3.new(1, 1, 1)
label.BackgroundColor3 = Color3.new(0.2, 0.2, 0.2)

### Обработка кликов

-- Создание кнопки
local button = Instance.new("TextButton")
button.Parent = gui
button.Text = "Click Me!"
button.Size = UDim2.new(0, 100, 0, 50)
button.Position = UDim2.new(0.5, -50, 0, 80)

-- Обработчик клика
button.MouseButton1Click:Connect(function()
    print("Button clicked!")
    button.Text = "Clicked!"
end)

-- Создание невидимой зоны
local trigger = Instance.new("Part")
trigger.Parent = workspace
trigger.Size = Vector3.new(10, 10, 10)
trigger.Position = Vector3.new(0, 5, 0)
trigger.Transparency = 0.7
trigger.CanCollide = false

-- Детектор касаний
trigger.Touched:Connect(function(otherPart)
    if otherPart:IsDescendantOf(game.Players.LocalPlayer.Character) then
        print("Player entered the zone!")
    end
end)

### Работа с лучами (Raycasting)

-- Создание луча от камеры
local ray = Ray.new(
    workspace.CurrentCamera.CFrame.Position,
    workspace.CurrentCamera.CFrame.LookVector * 50
)

-- Проверка пересечений
local hit, position = workspace:FindPartOnRay(ray)
if hit then
    print("Hit:", hit.Name, "at position:", position)
end

## Оптимизация и лучшие практики

### Эффективное кодирование

-- Используйте local переменные
local mathFloor = math.floor

-- Избегайте глобальных переменных
_G.myGlobal = "Avoid this!" -- Плохо

-- Кеширование часто используемых объектов
local RunService = game:GetService("RunService")

-- Оптимизация циклов
for i = 1, 1000 do
    -- Минимизируйте операции внутри циклов
end

### Управление памятью

-- Уничтожение объектов при завершении
part:Destroy()

-- Отмена подключений к событиям
local connection = event.Event:Connect(function() end)
connection:Disconnect()

-- Избегайте утечек памяти
collectgarbage("collect") -- Принудительный сбор мусора

-- Замер времени выполнения
local start = os.clock()
-- Код для замера
local duration = os.clock() - start
print("Execution time:", duration)

-- Использование встроенного профилировщика
game:GetService("ScriptProfiler"):Start()
-- Код для профилирования
game:GetService("ScriptProfiler"):Stop()

## Продвинутые техники

### Модули и ООП

-- Создание модуля (ModuleScript)
local MyModule = {}
function MyModule.new(name)
    local obj = {}
    obj.Name = name
    
    function obj:Greet()
        print("Hello, " .. self.Name)
    end
    
    return obj
end
return MyModule

-- Использование модуля
local MyModule = require(script.Parent.MyModule)
local instance = MyModule.new("Player1")
instance:Greet()

-- Создание RemoteEvent (сервер)
local remoteEvent = Instance.new("RemoteEvent")
remoteEvent.Name = "PlayerMessage"
remoteEvent.Parent = game.ReplicatedStorage

-- Серверная обработка
remoteEvent.OnServerEvent:Connect(function(player, message)
    print(player.Name .. " says: " .. message)
end)

-- Клиентская отправка (LocalScript)
local remoteEvent = game.ReplicatedStorage:WaitForChild("PlayerMessage")
remoteEvent:FireServer("Hello from client!")

-- Сохранение данных игрока
local DataStoreService = game:GetService("DataStoreService")
local playerData = DataStoreService:GetDataStore("PlayerData")

game.Players.PlayerAdded:Connect(function(player)
    local data = playerData:GetAsync(player.UserId) or {}
    player.leaderstats = Instance.new("Folder")
    player.leaderstats.Name = "leaderstats"
    
    local coins = Instance.new("IntValue")
    coins.Name = "Coins"
    coins.Value = data.Coins or 0
    coins.Parent = player.leaderstats
end)

-- Сохранение при выходе
game.Players.PlayerRemoving:Connect(function(player)
    local data = {
        Coins = player.leaderstats.Coins.Value
    }
    playerData:SetAsync(player.UserId, data)
end)

- **Workspace**: Основное игровое пространство
    
- **Lighting**: Управление освещением и атмосферой
    
- **SoundService**: Управление звуками
    
- **HttpService**: HTTP-запросы к внешним API
    
- **PathfindingService**: Построение путей для ИИ
    
- **TweenService**: Анимация свойств объектов
    

### Основные классы объектов

- **Part**: Базовый строительный блок
    
- **MeshPart**: Часть с пользовательской геометрией
    
- **Union**: Объединенные части
    
- **Script**: Серверный скрипт
    
- **LocalScript**: Клиентский скрипт
    
- **SurfaceGui**: GUI на поверхности объектов
    
- **BillboardGui**: GUI, всегда обращенный к камере